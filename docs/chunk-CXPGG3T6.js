import{a as q}from"./chunk-3VN4Z6TY.js";import{A as M,C as K,D as C,E as v,b as U,e as b,f as h,l as x,p as _,s as Y,t as W,w as H,x as V,z as k}from"./chunk-MJME3ZUI.js";import"./chunk-IZYWPJE6.js";import"./chunk-QUJFQN2Y.js";import"./chunk-UPSG4ROG.js";import"./chunk-JB7YE2UN.js";import"./chunk-ZREP5C5K.js";import"./chunk-2PO6VATE.js";import"./chunk-7JAWQQGQ.js";import"./chunk-TYZ6ZTL7.js";import"./chunk-7FY2OE2O.js";import"./chunk-YXZ2TWS3.js";import"./chunk-IXRY6M2E.js";import"./chunk-OEU2GXHJ.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-DUUW6K7E.js";import"./chunk-CKP3SGE2.js";import"./chunk-E25QA4ES.js";import{$ as z,C as f,D as i,E as r,F as y,M as d,W as a,Xa as R,Y as w,Z as F,_ as E,_a as B,aa as N,ca as P,db as L,ea as O,ia as j,na as A,oa as g,r as c,t as p,v as u,va as D,z as S}from"./chunk-I3SMBZLJ.js";import"./chunk-IGVXFY24.js";import"./chunk-5TIAO6TV.js";import"./chunk-BANGDX2W.js";import"./chunk-FZQDFHAZ.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-XTVTS2NW.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as m}from"./chunk-JHI3MBHO.js";function Z(s,o){if(s&1&&(i(0,"ion-select-option",9),a(1),r()),s&2){let I=o.$implicit;f("value",I),c(),w(" ",I.title," ")}}var G=(()=>{let o=class o{constructor(t){this.modalCtrl=t,this.tasks=[],this.selectedTask=null}confirm(){this.modalCtrl.dismiss(this.selectedTask)}close(){this.modalCtrl.dismiss()}};o.\u0275fac=function(n){return new(n||o)(p(C))},o.\u0275cmp=u({type:o,selectors:[["app-focus-select-modal"]],inputs:{tasks:"tasks"},decls:18,vars:3,consts:[["slot","end"],[1,"close-btn",3,"click"],[1,"modal-center"],[1,"task-details-card"],["lines","none"],["position","stacked"],["placeholder","Seleziona Task","interface","popover",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["expand","block",1,"start",3,"click","disabled"],[3,"value"]],template:function(n,e){n&1&&(i(0,"ion-header")(1,"ion-toolbar")(2,"ion-title")(3,"b"),a(4,"Seleziona Task"),r()(),i(5,"ion-buttons",0)(6,"ion-button",1),d("click",function(){return e.close()}),a(7,"\u2715"),r()()()(),i(8,"ion-content")(9,"div",2)(10,"div",3)(11,"ion-item",4)(12,"ion-label",5),a(13,"Task"),r(),i(14,"ion-select",6),N("ngModelChange",function(T){return z(e.selectedTask,T)||(e.selectedTask=T),T}),S(15,Z,2,2,"ion-select-option",7),r()(),i(16,"ion-button",8),d("click",function(){return e.confirm()}),a(17," Avvia Focus "),r()()()()),n&2&&(c(14),E("ngModel",e.selectedTask),c(),f("ngForOf",e.tasks),c(),f("disabled",!e.selectedTask))},dependencies:[v,b,h,x,_,Y,W,H,V,k,M,U,g,j,L,R,B],styles:["[_nghost-%COMP%]{color:#344c3d}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #f2d1d4}ion-header[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-family:var(--font-pixel);font-weight:700;font-size:22px;letter-spacing:1px;text-align:center;color:#344c3d}ion-button.close-btn[_ngcontent-%COMP%]{font-family:var(--font-pixel);font-size:14px;color:#344c3d}ion-button.close-btn[_ngcontent-%COMP%]:hover{color:#d8959b}ion-content[_ngcontent-%COMP%]{--ion-background-color: trasparent;background-image:linear-gradient(#fff6,#fff6),url(/assets/background/background-focus-task.png);background-size:cover;background-position:center;background-repeat:no-repeat;background-attachment:fixed;padding:20px}.modal-center[_ngcontent-%COMP%]{min-height:100%;display:flex;justify-content:center;align-items:center}.task-details-card[_ngcontent-%COMP%]{background-color:#fff;width:100%;max-width:380px;padding:22px;border-radius:16px;display:flex;flex-direction:column;gap:20px;box-shadow:0 6px 18px #0000001a}.task-details-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent;padding:0}ion-label[_ngcontent-%COMP%]{font-family:var(--font-pixel);font-size:14px;color:#344c3d;margin-bottom:6px}ion-select[_ngcontent-%COMP%]{--background: #fdf7f2;--color: #344c3d;--placeholder-color: #aaa;--padding-start: 12px;--padding-end: 12px;height:48px;border-radius:10px;box-shadow:0 4px 12px #00000014;font-family:var(--font-pixel);letter-spacing:1px}ion-select[_ngcontent-%COMP%]::part(text){font-family:var(--font-pixel);font-size:15px;color:#344c3d}ion-select-option[_ngcontent-%COMP%]{font-family:var(--font-pixel);font-size:14px;color:#344c3d;background:#fdf7f2}  ion-popover{--background: #f2d1d4;--border-radius: 12px;--box-shadow: 0 4px 12px rgba(0,0,0,.2);overflow:hidden}  ion-popover .select-interface-option{--background: #f2d1d4;background-color:#f2d1d4;font-family:var(--font-pixel);letter-spacing:1px;color:#344c3d;font-size:14px}ion-button.start[_ngcontent-%COMP%]{--background: #829672;--color: #ffffff;font-family:var(--font-pixel);letter-spacing:2px;font-size:15px;height:48px;border-radius:999px;transition:transform .2s ease,box-shadow .2s ease}ion-button.start[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #00000026}ion-button.start[_ngcontent-%COMP%]:active{transform:scale(.96)}ion-button.start[disabled][_ngcontent-%COMP%]{opacity:.5;box-shadow:none;transform:none}"]});let s=o;return s})();var lt=(()=>{let o=class o{constructor(t,n,e,l){this.router=t,this.alertCtrl=n,this.taskService=e,this.modalCtrl=l,this.INITIAL_MINUTES=25,this.timerMinutes=this.INITIAL_MINUTES,this.timerSeconds=0,this.isRunning=!1,this.tasks=[],this.selectedTask=null}ngOnInit(){this.loadTasks()}ngOnDestroy(){clearInterval(this.intervalId)}loadTasks(){this.taskService.getTasks().subscribe({next:t=>{this.tasks=t,console.log("Tasks caricate",t)},error:t=>console.error("Errore caricamento tasks:",t)})}openTaskModal(){return m(this,null,function*(){let t=yield this.modalCtrl.create({component:G,componentProps:{tasks:this.tasks}});t.onDidDismiss().then(n=>{n.data&&(this.selectedTask=n.data,this.startTimer())}),yield t.present()})}startTimer(){!this.selectedTask||this.isRunning||(this.isRunning=!0,this.intervalId=setInterval(()=>{if(this.timerSeconds===0){if(this.timerMinutes===0){this.onTimerCompleted();return}this.timerMinutes--,this.timerSeconds=59}else this.timerSeconds--},1e3))}pauseTimer(){this.isRunning=!1,clearInterval(this.intervalId)}resetTimer(){this.pauseTimer(),this.timerMinutes=this.INITIAL_MINUTES,this.timerSeconds=0}onTimerCompleted(){this.pauseTimer(),this.saveSession(!0),this.showTimeFinishedAlert(),this.resetTimer()}saveSession(t){if(!this.selectedTask)return;let n=this.INITIAL_MINUTES-(this.timerMinutes+this.timerSeconds/60);n<=0||this.taskService.addFocusSession({subject:this.selectedTask.title,minutes:Math.round(n),completed:t,day:new Date}).subscribe()}showTimeFinishedAlert(){return m(this,null,function*(){yield(yield this.alertCtrl.create({header:"Tempo finito!",message:"Sessione completata :)",buttons:["OK"]})).present()})}closeFocus(){return m(this,null,function*(){this.isRunning?yield(yield this.alertCtrl.create({header:"Timer attivo!",message:"Vuoi uscire e salvare i minuti fatti finora?",cssClass:"custom-alert",buttons:[{text:"Annulla",role:"cancel",cssClass:"cancel-btn"},{text:"Esci",role:"destructive",cssClass:"exit-btn",handler:()=>{this.pauseTimer(),this.saveSession(!1),this.router.navigate(["/planner"])}}]})).present():this.router.navigate(["/planner"])})}};o.\u0275fac=function(n){return new(n||o)(p(D),p(K),p(q),p(C))},o.\u0275cmp=u({type:o,selectors:[["app-focus"]],decls:22,vars:10,consts:[["slot","end"],[1,"close-btn",3,"click"],[1,"focus-page","ion-padding"],[1,"focus-wrapper"],[1,"time-container"],["src","assets/icon/timer.jpeg",1,"focus-image"],[1,"timer"],[1,"buttons"],[1,"start",3,"click","disabled"],[1,"pause",3,"click","disabled"],[1,"reset",3,"click"]],template:function(n,e){n&1&&(i(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),a(3,"Focus Mode"),r(),i(4,"ion-buttons",0)(5,"ion-button",1),d("click",function(){return e.closeFocus()}),a(6,"\u2715"),r()()()(),i(7,"ion-content",2)(8,"div",3)(9,"div",4),y(10,"img",5),i(11,"h1",6),a(12),P(13,"number"),P(14,"number"),r(),i(15,"div",7)(16,"ion-button",8),d("click",function(){return e.openTaskModal()}),a(17," Start "),r(),i(18,"ion-button",9),d("click",function(){return e.pauseTimer()}),a(19," Pause "),r(),i(20,"ion-button",10),d("click",function(){return e.resetTimer()}),a(21," Reset "),r()()()()()),n&2&&(c(12),F(" ",O(13,4,e.timerMinutes,"2.0"),":",O(14,7,e.timerSeconds,"2.0")," "),c(4),f("disabled",e.isRunning),c(2),f("disabled",!e.isRunning))},dependencies:[v,b,h,x,_,k,M,g,A],styles:["[_nghost-%COMP%]{--ion-background-color: #f4f3f1;--ion-text-color: #344c3d}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #f2d1d4;color:#344c3d}ion-header[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{color:#344c3d;font-family:var(--font-pixel);font-size:25px;text-align:center;letter-spacing:1px}ion-content[_ngcontent-%COMP%]{--ion-background-color: trasparent;background-image:linear-gradient(#ffffff26,#ffffff26),url(/assets/background/sfondo-focus.png);background-size:cover;background-position:center;background-repeat:no-repeat;background-attachment:fixed}.focus-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding-top:30px}.time-container[_ngcontent-%COMP%]{background:#fff;padding:20px 24px;border-radius:20px;text-align:center;width:100%;max-width:320px;box-shadow:0 10px 25px #0000002e}.focus-image[_ngcontent-%COMP%]{width:140px;margin:0 auto 16px;display:block;opacity:.85;filter:saturate(.9) blur(.2px)}.timer[_ngcontent-%COMP%]{font-size:56px;font-weight:600;letter-spacing:2px;color:#344c3d;margin-top:1px;margin-bottom:10px;font-family:var(--font-pixel);font-size:65px;font-weight:lighter}.buttons[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1;--border-radius: 14px;font-weight:500}.start[_ngcontent-%COMP%]{--background: #829672;color:#fff;font-weight:700;font-family:var(--font-pixel)}.start[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 15px #0000001a;border-radius:14px}.pause[_ngcontent-%COMP%]{--background: #d8ce95;font-weight:700;font-family:var(--font-pixel)}.pause[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 15px #0000001a;border-radius:14px}.reset[_ngcontent-%COMP%]{--background: #d8959b;color:#fff;font-weight:700;font-family:var(--font-pixel)}.reset[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 15px #0000001a;border-radius:14px}.custom-alert[_ngcontent-%COMP%]{--background: #fdf7f2;--color: #344c3d;--border-radius: 16px;--box-shadow: 0 8px 20px rgba(0,0,0,.15);font-family:var(--font-pixel)}.custom-alert[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{--color: #d8959b;--background: #fff0f2;border-radius:999px}.custom-alert[_ngcontent-%COMP%]   .exit-btn[_ngcontent-%COMP%]{--color: #fff;--background: #829672;border-radius:999px}"]});let s=o;return s})();export{lt as FocusPage};
